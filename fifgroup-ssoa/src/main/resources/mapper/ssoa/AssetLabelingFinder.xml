<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="co.id.fifgroup.ssoa.finder.AssetLabelingFinder">
	<resultMap id="BaseResultMap" type="co.id.fifgroup.ssoa.dto.AssetLabelingDTO">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Feb 27 
			20:51:34 ICT 2013. -->
	    <id column="LABELING_ID" property="labelingId" jdbcType="DECIMAL" />
	    <result column="LABELING_DATE" property="labelingDate" jdbcType="TIMESTAMP" />
	    <result column="BRANCH_ID" property="branchId" jdbcType="VARCHAR" />	
	    <result column="DESCRIPTION" property="description" jdbcType="VARCHAR" />
	    <result column="CREATED_BY" property="createdBy" jdbcType="DECIMAL" />
	    <result column="CREATION_DATE" property="creationDate" jdbcType="TIMESTAMP" />
	    <result column="LAST_UPDATED_BY" property="lastUpdatedBy" jdbcType="DECIMAL" />
	    <result column="LAST_UPDATE_DATE" property="lastUpdateDate" jdbcType="TIMESTAMP" />
	    <result column="START_DATE" property="startDate" jdbcType="TIMESTAMP" />
	    <result column="END_DATE" property="endDate" jdbcType="TIMESTAMP" />
	    <result column="USER_NAME" property="userName" jdbcType="VARCHAR" />
	    <result column="FULL_NAME" property="fullName" jdbcType="VARCHAR" />
	</resultMap>
	
	<sql id="Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Mar 19 22:59:29 ICT 2013.
    -->
    <where>
      <foreach collection="orderCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>

	<select id="selectByExample" resultMap="BaseResultMap"
		parameterType="co.id.fifgroup.ssoa.domain.AssetLabelingExample">
		SELECT DISTINCT
		LH.LABELING_ID,
		LH.LABELING_DATE,
		LH.BRANCH_ID,
		(CASE WHEN LH.DESCRIPTION IS NULL THEN '-' ELSE LH.DESCRIPTION end) DESCRIPTION,
		LH.CREATED_BY,
		LH.CREATION_DATE,
		LH.LAST_UPDATE_DATE,
		LH.LAST_UPDATE_BY,
		U.USER_NAME,
		 (SELECT CONCAT(concat(PEA.EMPLOYEE_NUMBER,'-'),PEA.FULL_NAME) FROM pea_personal_informations PEA 
                        WHERE ROWNUM = 1 AND PEA.EMPLOYEE_NUMBER = U.USER_NAME) AS FULL_NAME
        FROM
        SOC_ASSET_LABELING_HDR LH
        LEFT JOIN SAM_USERS U ON U.USER_ID = LH.LAST_UPDATE_BY
		<if test="_parameter != null">
      		<include refid="Example_Where_Clause" />
    	</if>
		<if test="orderByClause != null">
             order by ${orderByClause}
    	</if>
	</select>

	<select id="countByExample" resultType="int"
		parameterType="co.id.fifgroup.ssoa.domain.AssetLabelingExample">
		SELECT count(*)
		FROM SOC_ASSET_LABELING_HDR LH
		<if test="_parameter != null">
      		<include refid="Example_Where_Clause" />
    	</if>
	</select>

	<resultMap id="DetailMap"
		type="co.id.fifgroup.ssoa.dto.AssetLabelingDetailDTO">
		<id column="LABELING_DTL_ID" property="assetLabelingDetail.assetLabelingDtlId"
			jdbcType="VARCHAR" />
		<result column="LABELING_ID" property="assetLabelingDetail.assetLabelingHdrId"
			jdbcType="VARCHAR" />
		<result column="ASSET_NO" property="assetLabelingDetail.assetNo"
			jdbcType="VARCHAR" />
		<result column="REPRINTING_REASON" property="assetLabelingDetail.reprintingReason"
			jdbcType="VARCHAR" />
		<!-- <result column="main_task" property="mainTask.taskName"
			jdbcType="VARCHAR" />
		<result column="description" property="mainTask.description"
			jdbcType="VARCHAR" />
		<result column="m_class_name" property="mainTask.className"
			jdbcType="VARCHAR" />
		<result column="m_task_type" property="mainTask.taskType"
			jdbcType="VARCHAR" />
		<result column="m_print" property="mainTask.printAfterCompleted"
			jdbcType="NUMERIC" />
		<result column="m_save" property="mainTask.saveAfterCompleted"
			jdbcType="NUMERIC" />
		<result column="m_format" property="mainTask.outputFormat"
			jdbcType="VARCHAR" />
		<result column="SCCUESS_TASK_ID" property="parameterDetail.sccuessTaskId"
			jdbcType="DECIMAL" />
		<result column="success_task" property="successTask.taskName"
			jdbcType="VARCHAR" />
		<result column="s_class_name" property="successTask.className"
			jdbcType="VARCHAR" />
		<result column="s_task_type" property="successTask.taskType"
			jdbcType="VARCHAR" />
		<result column="s_print" property="successTask.printAfterCompleted"
			jdbcType="NUMERIC" />
		<result column="s_save" property="successTask.saveAfterCompleted"
			jdbcType="NUMERIC" />
		<result column="s_format" property="successTask.outputFormat"
			jdbcType="VARCHAR" />
		<result column="ERROR_TASK_ID" property="parameterDetail.errorTaskId"
			jdbcType="DECIMAL" />
		<result column="error_task" property="errorTask.taskName"
			jdbcType="VARCHAR" />
		<result column="e_class_name" property="errorTask.className"
			jdbcType="VARCHAR" />
		<result column="e_task_type" property="errorTask.taskType"
			jdbcType="VARCHAR" />
		<result column="e_print" property="errorTask.printAfterCompleted"
			jdbcType="NUMERIC" />
		<result column="e_save" property="errorTask.saveAfterCompleted"
			jdbcType="NUMERIC" />
		<result column="e_format" property="errorTask.outputFormat"
			jdbcType="VARCHAR" /> -->
	</resultMap>

	<select id="selectDetailByHeaderId" resultMap="DetailMap"
		parameterType="java.lang.String">
		select
		ALDT.LABELING_DTL_ID,
		ALDT.LABELING_ID,
		ALDT.ASSET_NO,
		ALDT.REPRINTING_REASON
		from SOC_ASSET_LABELING_DTL ALDT left join
		where ALDT.LABELING_ID = #{labelingId, jdbcType=VARCHAR}
		order by LABELING_ID asc
	</select>
	
	<resultMap type="co.id.fifgroup.core.ui.lookup.KeyValue" id="BaseResultMapKeyValue">
		<result column="KEY" property="key" javaType="java.lang.Object"/>
		<result column="VALUE" property="value" javaType="java.lang.Object"/>
		<result column="DESCRIPTION" property="description" javaType="java.lang.Object"/>
	</resultMap>
	  <select id="getLookupKeyValues" parameterType="map" resultMap="BaseResultMapKeyValue">
			SELECT DISTINCT
			    bld.DETAIL_CODE KEY,
				bld.DETAIL_CODE VALUE,
				bld.DESCRIPTION DESCRIPTION
			FROM bse_lookup_hdr blh
	    	join BSE_LOOKUP_DEPENDENTS bld on bld.lookup_id = blh.lookup_id
			WHERE
	      		blh.name = #{lookupName}
	      	<if test="key != null">
				AND	UPPER(bld.DETAIL_CODE) like 
					(UPPER(#{key}))
	      	</if>
	      	ORDER BY bld.DESCRIPTION ASC
		</select>

</mapper>