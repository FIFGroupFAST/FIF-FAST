<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="co.id.fifgroup.ssoa.finder.ParameterFinder">
	<resultMap id="BaseResultMap" type="co.id.fifgroup.ssoa.dto.ParameterDTO">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Feb 27 
			20:51:34 ICT 2013. -->
		<id column="PARAMETER_CODE" property="parameterCode" jdbcType="VARCHAR" />
		<result column="PARAMETER_NAME" property="parameterName"
			jdbcType="VARCHAR" />
		<result column="CREATED_BY" property="createdBy" jdbcType="DECIMAL" />
		<result column="CREATION_DATE" property="creationDate"
			jdbcType="TIMESTAMP" />
		<result column="LAST_UPDATE_BY" property="lastUpdateBy"
			jdbcType="DECIMAL" />
		<result column="LAST_UPDATE_DATE" property="lastUpdateDate"
			jdbcType="TIMESTAMP" />
		<result column="USER_NAME" property="userName" jdbcType="VARCHAR" />
	</resultMap>

	<select id="selectByExample" resultMap="BaseResultMap"
		parameterType="co.id.fifgroup.ssoa.domain.Parameter">
		SELECT DISTINCT
		HD.PARAMETER_CODE,
		HD.PARAMETER_NAME,
		(SELECT
		COUNT(*) FROM
		SOC_PARAMETER_DTL WHERE
		PARAMETER_CODE =
		HD.PARAMETER_CODE) AS TASK_COUNT,
		HD.CREATED_BY,
		HD.CREATION_DATE,
		HD.LAST_UPDATE_DATE,
		HD.LAST_UPDATE_BY,
		U.USER_NAME
		FROM
		SOC_PARAMETER_HDR HD
		LEFT JOIN SAM_USERS U ON U.USER_ID =
		HD.LAST_UPDATE_BY
		<where>
		    <if test="example.parameterCode != null">
				 UPPER(HD.PARAMETER_CODE) LIKE
				(UPPER(#{example.parameterCode,jdbcType=VARCHAR}))
			</if>
			<if test="example.parameterName != null">
				 AND UPPER(HD.PARAMETER_NAME) LIKE
				(UPPER(#{example.parameterName,jdbcType=VARCHAR}))
			</if>
		</where>
		ORDER BY
		HD.PARAMETER_NAME, HD.LAST_UPDATE_DATE ASC
	</select>

	<select id="countByExample" resultType="int"
		parameterType="co.id.fifgroup.ssoa.domain.Parameter">
		SELECT count(*)
		FROM SOC_PARAMETER_HDR HD
		LEFT JOIN SAM_USERS U ON U.USER_ID = HD.LAST_UPDATE_BY
		<where>
			<if test="example.parameterName != null">
				UPPER(HD.PARAMETER_NAME) LIKE
				(UPPER(#{example.parameterName,jdbcType=VARCHAR}))
			</if>
		</where>
		ORDER BY HD.LAST_UPDATE_DATE DESC
	</select>

	<resultMap id="DetailMap"
		type="co.id.fifgroup.ssoa.dto.ParameterDetailDTO">
		<id column="PARAMETER_DTL_CODE" property="parameterDetail.parameterDtlCode"
			jdbcType="VARCHAR" />
		<result column="PARAMETER_DTL_NAME" property="parameterDetail.parameterDtlName"
			jdbcType="VARCHAR" />
		<result column="PARAMETER_CODE" property="parameterDetail.parameterCode"
			jdbcType="VARCHAR" />
		<!-- <result column="main_task" property="mainTask.taskName"
			jdbcType="VARCHAR" />
		<result column="description" property="mainTask.description"
			jdbcType="VARCHAR" />
		<result column="m_class_name" property="mainTask.className"
			jdbcType="VARCHAR" />
		<result column="m_task_type" property="mainTask.taskType"
			jdbcType="VARCHAR" />
		<result column="m_print" property="mainTask.printAfterCompleted"
			jdbcType="NUMERIC" />
		<result column="m_save" property="mainTask.saveAfterCompleted"
			jdbcType="NUMERIC" />
		<result column="m_format" property="mainTask.outputFormat"
			jdbcType="VARCHAR" />
		<result column="SCCUESS_TASK_ID" property="parameterDetail.sccuessTaskId"
			jdbcType="DECIMAL" />
		<result column="success_task" property="successTask.taskName"
			jdbcType="VARCHAR" />
		<result column="s_class_name" property="successTask.className"
			jdbcType="VARCHAR" />
		<result column="s_task_type" property="successTask.taskType"
			jdbcType="VARCHAR" />
		<result column="s_print" property="successTask.printAfterCompleted"
			jdbcType="NUMERIC" />
		<result column="s_save" property="successTask.saveAfterCompleted"
			jdbcType="NUMERIC" />
		<result column="s_format" property="successTask.outputFormat"
			jdbcType="VARCHAR" />
		<result column="ERROR_TASK_ID" property="parameterDetail.errorTaskId"
			jdbcType="DECIMAL" />
		<result column="error_task" property="errorTask.taskName"
			jdbcType="VARCHAR" />
		<result column="e_class_name" property="errorTask.className"
			jdbcType="VARCHAR" />
		<result column="e_task_type" property="errorTask.taskType"
			jdbcType="VARCHAR" />
		<result column="e_print" property="errorTask.printAfterCompleted"
			jdbcType="NUMERIC" />
		<result column="e_save" property="errorTask.saveAfterCompleted"
			jdbcType="NUMERIC" />
		<result column="e_format" property="errorTask.outputFormat"
			jdbcType="VARCHAR" /> -->
	</resultMap>

	<select id="selectDetailByHeaderId" resultMap="DetailMap"
		parameterType="java.lang.String">
		select
		dt.parameter_dtl_code,
		dt.parameter_dtl_name,
		dt.parameter_code
		from sam_parameter_dtl dt left join
		where dt.parameter_code = #{parameterCode, jdbcType=VARCHAR}
		order by parameter_code asc
	</select>

</mapper>